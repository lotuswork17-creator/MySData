<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
<title>TipsCompare Viewer</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;600&family=Outfit:wght@400;500;600;700;800&display=swap');
:root{--bg:#0f1117;--surface:#181c27;--surface2:#1f2536;--border:#2b3048;--accent:#4ade80;--accent2:#60a5fa;--warn:#fb923c;--text:#e8eaf0;--muted:#64748b;--mono:'IBM Plex Mono',monospace;--sans:'Outfit',sans-serif}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
html,body{height:100%;overflow:hidden}
body{background:var(--bg);color:var(--text);font-family:var(--sans);font-size:14px;display:flex;flex-direction:column;height:100vh}

/* HEADER */
header{background:var(--surface);border-bottom:1px solid var(--border);padding:10px 14px;flex-shrink:0}
.header-top{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:10px}
.logo{display:flex;align-items:center;gap:8px}
.logo-dot{width:9px;height:9px;border-radius:50%;background:var(--accent);box-shadow:0 0 7px var(--accent);flex-shrink:0}
.logo h1{font-size:15px;font-weight:800}
.logo span{color:var(--muted);font-weight:400}
.hstats{display:flex;gap:5px;flex-wrap:wrap}
.hstat{padding:3px 8px;border-radius:5px;border:1px solid var(--border);color:var(--muted);font-family:var(--mono);font-size:10px;white-space:nowrap}
.hstat b{color:var(--text)}
.updated{font-size:10px;color:var(--muted);font-family:var(--mono);white-space:nowrap}

/* FILTERS */
.filter-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.filter-toggle{display:flex;align-items:center;gap:5px;padding:4px 10px;border-radius:6px;border:1px solid var(--border);background:var(--surface2);color:var(--muted);font-size:11px;font-family:var(--sans);font-weight:600;cursor:pointer;white-space:nowrap;transition:color .15s,border-color .15s}
.filter-toggle.active{color:var(--accent2);border-color:rgba(96,165,250,.4)}
.ft-arrow{font-size:9px;transition:transform .2s;display:inline-block}
.filter-toggle.collapsed .ft-arrow{transform:rotate(-90deg)}
.filters{display:flex;flex-wrap:wrap;gap:7px}
.filters.collapsed{display:none}
.fg{display:flex;flex-direction:column;gap:3px;flex:1;min-width:130px}
.fl{font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.05em}
input,select{background:var(--surface2);border:1px solid var(--border);border-radius:7px;color:var(--text);font-family:var(--sans);font-size:13px;padding:7px 10px;outline:none;width:100%;transition:border-color .15s;appearance:none;-webkit-appearance:none}
input:focus,select:focus{border-color:var(--accent2)}
input::placeholder{color:var(--muted)}
.btn-clear{padding:7px 12px;border-radius:7px;font-size:12px;font-weight:600;font-family:var(--sans);cursor:pointer;border:1px solid var(--border);background:var(--surface2);color:var(--muted);white-space:nowrap;align-self:flex-end;min-height:34px}
.btn-clear:active{color:var(--text)}

/* RESULTS BAR */
.results-bar{padding:5px 14px;font-size:11px;color:var(--muted);font-family:var(--mono);display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid var(--border);flex-shrink:0;flex-wrap:wrap;gap:2px}
.results-bar b{color:var(--accent)}

/* ASIA STATS PANEL */
#asiaStats{background:var(--surface);border-bottom:1px solid var(--border);padding:10px 14px;flex-shrink:0;display:none}
.as-title{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--muted);margin-bottom:8px;font-family:var(--sans)}
.as-row{display:flex;gap:6px;align-items:stretch;margin-bottom:7px;flex-wrap:wrap}
.as-card{flex:1;min-width:56px;background:var(--surface2);border-radius:8px;padding:7px 10px;border:1px solid var(--border);display:flex;flex-direction:column;gap:2px}
.as-card.ww{border-color:rgba(74,222,128,.35)}
.as-card.wh{border-color:rgba(134,239,172,.2)}
.as-card.dd{border-color:rgba(148,163,184,.2)}
.as-card.lh{border-color:rgba(147,197,253,.2)}
.as-card.lw{border-color:rgba(96,165,250,.35)}
.as-card-label{font-size:9px;color:var(--muted);font-weight:600;text-transform:uppercase;letter-spacing:.04em;white-space:nowrap}
.as-card-pct{font-size:20px;font-weight:800;font-family:var(--mono);line-height:1}
.as-card-count{font-size:11px;font-family:var(--mono);color:var(--muted)}
.as-card.ww .as-card-pct{color:#4ade80}
.as-card.wh .as-card-pct{color:#86efac}
.as-card.dd .as-card-pct{color:#94a3b8}
.as-card.lh .as-card-pct{color:#93c5fd}
.as-card.lw .as-card-pct{color:#60a5fa}
.as-bar-wrap{height:8px;border-radius:4px;background:var(--border);display:flex;overflow:hidden;gap:1px}
.as-bar-ww{background:#4ade80}
.as-bar-wh{background:#86efac}
.as-bar-dd{background:#475569}
.as-bar-lh{background:#93c5fd}
.as-bar-lw{background:#60a5fa}
@media(max-width:480px){
  .as-card{padding:6px 8px}
  .as-card-count{font-size:15px}
  .as-card-label{font-size:8px}
}

/* LOADING / ERROR */
#loadingState{display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;gap:14px;color:var(--muted)}
.spinner{width:32px;height:32px;border:3px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
#errorState{display:none;flex-direction:column;align-items:center;justify-content:center;flex:1;gap:10px;color:var(--muted);text-align:center;padding:24px}
#errorState h2{color:#f87171;font-size:16px}
.retry-btn{padding:8px 18px;background:var(--surface2);border:1px solid var(--border);border-radius:7px;color:var(--text);font-size:13px;font-family:var(--sans);cursor:pointer;font-weight:600}

/* TABLE SCROLL */
.table-scroll{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}

/* DESKTOP TABLE */
@media(min-width:600px){
  table{width:100%;border-collapse:collapse;font-size:12px;min-width:600px}
  thead th{padding:8px 10px;text-align:left;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--muted);white-space:nowrap;cursor:pointer;user-select:none;border-bottom:2px solid var(--border);background:var(--surface);font-family:var(--sans);transition:color .15s}
  thead th:hover{color:var(--text)}
  thead th.sort-asc,thead th.sort-desc{color:var(--accent2)}
  thead th .si{font-size:9px;margin-left:2px;opacity:.3}
  thead th.sort-asc .si,thead th.sort-desc .si{opacity:1}
  tbody tr{border-bottom:1px solid var(--border);cursor:pointer;transition:background .1s}
  tbody tr:hover{background:var(--surface2)}
  tbody tr.selected{background:#1a2640;border-left:3px solid var(--accent2)}
  td{padding:8px 10px;white-space:nowrap;overflow:hidden;max-width:150px;text-overflow:ellipsis;color:#c0c8d8;font-family:var(--mono);font-size:11px}
  td.tcell{font-family:var(--sans);font-size:12px;color:var(--text);font-weight:500}
  td.ccell{font-family:var(--sans);font-size:11px;color:var(--muted)}
  .oc{color:#94a3b8}
}

/* MOBILE CARDS */
@media(max-width:599px){
  table,thead,tbody,tr,th,td{display:block;width:100%}
  /* Override for odds tables ‚Äî keep as real tables on mobile */
  table.ot,table.ot thead,table.ot tbody,table.ot tr,table.ot th,table.ot td{display:revert;width:auto}
  thead{display:none}
  tbody tr{background:var(--surface);border:1px solid var(--border);border-radius:10px;margin:8px 10px;padding:12px;cursor:pointer;position:relative}
  tbody tr:active{background:var(--surface2)}
  tbody tr.selected{border-color:var(--accent2);background:#1a2640}
  td{padding:0;border:none;white-space:normal;max-width:100%;overflow:visible}
}

.score{font-weight:700;color:var(--text)}
.status-badge{display:inline-block;padding:2px 7px;border-radius:4px;font-size:10px;font-weight:700;font-family:var(--sans);white-space:nowrap}
.s-result{background:rgba(74,222,128,.1);color:var(--accent);border:1px solid rgba(74,222,128,.2)}
.s-preeve{background:rgba(96,165,250,.1);color:var(--accent2);border:1px solid rgba(96,165,250,.2)}
.s-cancel{background:rgba(148,163,184,.08);color:var(--muted);border:1px solid rgba(148,163,184,.15)}
mark{background:rgba(96,165,250,.2);color:var(--accent2);border-radius:2px;padding:0 1px}
.empty{text-align:center;padding:50px 20px;color:var(--muted)}
.empty span{font-size:28px;display:block;margin-bottom:8px}

/* PAGINATION */
.pagination{padding:8px 14px;display:none;align-items:center;gap:4px;flex-wrap:wrap;font-family:var(--mono);font-size:11px;border-top:1px solid var(--border);flex-shrink:0;background:var(--surface)}
.pagination.pg-visible{display:flex}
.pg-btn{width:30px;height:30px;border-radius:6px;border:1px solid var(--border);background:var(--surface2);color:var(--text);cursor:pointer;font-size:12px;display:flex;align-items:center;justify-content:center}
.pg-btn:active{border-color:var(--accent2);color:var(--accent2)}
.pg-btn.active{background:var(--accent2);color:#0f1117;border-color:var(--accent2);font-weight:700}
.pg-btn[disabled]{opacity:.3;cursor:default;pointer-events:none}
.pg-info{color:var(--muted);margin:0 6px}
.pg-input{width:46px;height:30px;border-radius:6px;border:1px solid var(--border);background:var(--surface2);color:var(--text);font-family:var(--mono);font-size:12px;text-align:center;outline:none;padding:0 4px}
.pg-input:focus{border-color:var(--accent2)}
@media(max-width:599px){
  .pagination{flex-wrap:wrap;justify-content:center;padding:10px 8px;gap:6px}
  .pg-btn{width:36px;height:36px;font-size:14px;flex-shrink:0}
  .pg-info{width:100%;text-align:center;margin:4px 0 0}
  .pg-input{width:50px;height:36px;font-size:13px}
}

/* DETAIL PANEL */
.panel-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:999;align-items:flex-end;justify-content:center}
.panel-overlay.open{display:flex}
@keyframes slideUp{from{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}
.panel{background:var(--surface);border:1px solid var(--border);border-radius:16px 16px 0 0;width:100%;max-width:860px;max-height:88vh;overflow-y:auto;-webkit-overflow-scrolling:touch;animation:slideUp .2s ease}
.ph{padding:14px 16px 12px;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:flex-start;position:sticky;top:0;background:var(--surface);z-index:1;border-radius:16px 16px 0 0}
.ph::before{content:'';position:absolute;top:8px;left:50%;transform:translateX(-50%);width:36px;height:4px;background:var(--border);border-radius:2px}
.ph-title{font-size:16px;font-weight:700;margin-bottom:3px;line-height:1.3;padding-top:8px}
.ph-meta{font-size:11px;color:var(--muted);font-family:var(--mono)}
.pc-btn{width:28px;height:28px;border-radius:6px;background:var(--surface2);border:1px solid var(--border);color:var(--muted);font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin-top:8px}
.pb{padding:14px 16px 32px;display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media(max-width:480px){.pb{grid-template-columns:1fr}.dc.full{grid-column:1}}
.dc{background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:12px}
.dc.full{grid-column:1/-1}
.dc h3{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:var(--muted);margin-bottom:10px}
.dr{display:flex;justify-content:space-between;align-items:center;margin-bottom:7px;gap:8px}
.dr:last-child{margin-bottom:0}
.dk{color:var(--muted);font-size:11px;flex-shrink:0}
.dv{color:var(--text);font-family:var(--mono);font-weight:600;font-size:11px;text-align:right}
.sd{display:flex;align-items:center;justify-content:center;gap:10px;padding:8px 0}
.st{text-align:center;flex:1}
.st .stn{font-size:11px;color:var(--muted);margin-bottom:3px}
.st .ssc{font-size:30px;font-weight:800;font-family:var(--mono);line-height:1}
.sdiv{font-size:16px;color:var(--border);font-weight:700}
.hts{text-align:center;font-size:10px;color:var(--muted);font-family:var(--mono);margin-top:4px}
.pl{display:flex;justify-content:space-between;font-size:10px;color:var(--muted);margin-bottom:5px;font-family:var(--mono)}
.pbar{height:7px;border-radius:4px;background:var(--border);display:flex;overflow:hidden}
.ph2{background:var(--accent2)}.pd2{background:#a78bfa}.pa2{background:var(--warn)}
.tg{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;margin-top:6px}.tg2{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-top:6px}
.ti{background:var(--surface);border:1px solid var(--border);border-radius:7px;padding:8px 10px}
.tl{font-size:9px;color:var(--muted);margin-bottom:2px;text-transform:uppercase}
.tv{font-size:18px;font-weight:700;color:var(--accent);font-family:var(--mono)}
.ot{width:100%;border-collapse:collapse;font-family:var(--mono);font-size:11px;margin-top:4px}
.ot th{font-size:9px;color:var(--muted);text-align:center;padding:3px 4px;text-transform:uppercase;font-weight:600}
.ot td{text-align:center;padding:5px 4px;color:var(--text);font-weight:600;border-top:1px solid var(--border);font-size:11px}
.ot .ol{text-align:left;color:var(--muted);font-weight:400}
::-webkit-scrollbar{width:3px;height:3px}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}
</style>
</head>
<body>

<header>
  <div class="header-top">
    <div class="logo">
      <div class="logo-dot"></div>
      <h1>TipsCompare <span>Viewer</span></h1>
    </div>
    <div style="display:flex;flex-direction:column;align-items:flex-end;gap:4px">
      <span class="updated" id="updatedAt"></span>
      <div class="hstats">
        <div class="hstat">Total <b id="hTotal">‚Äî</b></div>
        <div class="hstat" style="border-color:rgba(74,222,128,.3)">Results <b id="hResult" style="color:var(--accent)">‚Äî</b></div>
        <div class="hstat" style="border-color:rgba(96,165,250,.3)">Upcoming <b id="hPreeve" style="color:var(--accent2)">‚Äî</b></div>
      </div>
    </div>
  </div>
  <div class="filter-header">
    <button class="filter-toggle active" id="filterToggle" onclick="toggleFilters()"><span id="filterToggleLabel">Hide Filters</span> <span class="ft-arrow">‚ñº</span></button>
    <span id="resultsInline" style="display:none;font-size:11px;color:var(--muted);font-family:var(--mono);margin-left:4px">Showing <b id="showCount" style="color:var(--accent)">0</b> of <b id="totalCount" style="color:var(--accent)">0</b></span>
  </div>
  <div class="filters" id="filtersPanel">
    <div class="fg" style="min-width:110px;max-width:150px">
      <div class="fl">Date Range</div>
      <select id="dateRangeSelect">
        <option value="">All Time</option>
        <option value="1">Last 1 Month</option>
        <option value="2">Last 2 Months</option>
        <option value="3">Last 3 Months</option>
        <option value="6">Last 6 Months</option>
        <option value="12">Last 12 Months</option>
      </select>
    </div>
    <div class="fg" style="min-width:110px;max-width:150px"><div class="fl">Search Teams</div><input type="text" id="searchInput" placeholder="Team name‚Ä¶"/></div>
    <div class="fg"><div class="fl">League</div><select id="catSelect"><option value="">All Leagues</option></select></div>
    <div class="fg" style="min-width:100px;max-width:120px">
      <div class="fl">Status</div>
      <select id="statusSelect">
        <option value="">All</option>
        <option value="Result">Result</option>
        <option value="PREEVE">Upcoming</option>
        <option value="Cancel">Cancelled</option>
        <option value="Closed">Closed</option>
        <option value="Suspen">Suspended</option>
      </select>
    </div>
    <div class="fg" style="min-width:100px;max-width:130px">
      <div class="fl">Asia Line</div>
      <select id="asialineSelect"><option value="">All Lines</option></select>
    </div>
    <div class="fg" style="min-width:130px;max-width:160px">
      <div class="fl">Predict Trend</div>
      <select id="predictSelect">
        <option value="">Any</option>
        <option value="H-lead">H Leaning (H highest)</option>
        <option value="D-lead">D Leaning (D highest)</option>
        <option value="A-lead">A Leaning (A highest)</option>
        <option disabled>‚îÄ‚îÄ H Side ‚îÄ‚îÄ</option>
        <option value="H-weak">H Mild (H &lt; 50%)</option>
        <option value="H-strong">H Backed (H ‚â• 50%)</option>
        <option value="H-vstrong">H Dominant (H ‚â• 70%)</option>
        <option disabled>‚îÄ‚îÄ A Side ‚îÄ‚îÄ</option>
        <option value="A-weak">A Mild (A &lt; 50%)</option>
        <option value="A-strong">A Backed (A ‚â• 50%)</option>
        <option value="A-vstrong">A Dominant (A ‚â• 70%)</option>
      </select>
    </div>
    <div class="fg" style="min-width:130px;max-width:160px">
      <div class="fl">Expert Signal</div>
      <select id="expertSelect">
        <option value="">Any</option>
        <option disabled>‚îÄ‚îÄ Direction ‚îÄ‚îÄ</option>
        <option value="H-dom">H Leaning (Expert H highest)</option>
        <option value="H-strong-e">H Backed (Expert H ‚â• 50%)</option>
        <option value="H-vstrong-e">H Dominant (Expert H ‚â• 70%)</option>
        <option value="H-ultra-e">H Overwhelming (Expert H ‚â• 90%)</option>
        <option value="A-dom">A Leaning (Expert A highest)</option>
        <option value="A-strong-e">A Backed (Expert A ‚â• 50%)</option>
        <option value="A-vstrong-e">A Dominant (Expert A ‚â• 70%)</option>
        <option value="A-ultra-e">A Overwhelming (Expert A ‚â• 90%)</option>
        <option disabled>‚îÄ‚îÄ vs Predict ‚îÄ‚îÄ</option>
        <option value="agree">Agrees with Predict</option>
        <option value="disagree">Disagrees with Predict</option>
        <option disabled>‚îÄ‚îÄ Confidence ‚îÄ‚îÄ</option>
        <option value="high-conf">High Confidence</option>
        <option value="high-conf-H">High Conf + H Leaning</option>
        <option value="high-conf-H50">High Conf + H ‚â• 50%</option>
        <option value="high-conf-H70">High Conf + H ‚â• 70%</option>
        <option value="high-conf-H90">High Conf + H ‚â• 90%</option>
        <option value="high-conf-A">High Conf + A Leaning</option>
        <option value="high-conf-A50">High Conf + A ‚â• 50%</option>
        <option value="high-conf-A70">High Conf + A ‚â• 70%</option>
        <option value="high-conf-A90">High Conf + A ‚â• 90%</option>
        <option value="low-conf">Low Confidence ‚ö†</option>
        <option value="low-conf-H">Low Conf ‚ö† + H Leaning</option>
        <option value="low-conf-H50">Low Conf ‚ö† + H ‚â• 50%</option>
        <option value="low-conf-H70">Low Conf ‚ö† + H ‚â• 70%</option>
        <option value="low-conf-H90">Low Conf ‚ö† + H ‚â• 90%</option>
        <option value="low-conf-A">Low Conf ‚ö† + A Leaning</option>
        <option value="low-conf-A50">Low Conf ‚ö† + A ‚â• 50%</option>
        <option value="low-conf-A70">Low Conf ‚ö† + A ‚â• 70%</option>
        <option value="low-conf-A90">Low Conf ‚ö† + A ‚â• 90%</option>
      </select>
    </div>
    <div class="fg" style="min-width:130px;max-width:160px">
      <div class="fl">Market Lean</div>
      <select id="marketSelect">
        <option value="">Any</option>
        <option value="balanced">Balanced (48‚Äì52%)</option>
        <option disabled>‚îÄ‚îÄ H Side ‚îÄ‚îÄ</option>
        <option value="h-slight">H Slight Edge (52‚Äì55%)</option>
        <option value="h-clear">H Clear Edge (55%+)</option>
        <option disabled>‚îÄ‚îÄ A Side ‚îÄ‚îÄ</option>
        <option value="a-slight">A Slight Edge (45‚Äì48%)</option>
        <option value="a-clear">A Clear Edge (45%-)</option>
      </select>
    </div>
    <div class="fg" style="min-width:110px;max-width:140px">
      <div class="fl">Vig Margin</div>
      <select id="vigSelect">
        <option value="">Any</option>
        <option value="vig-tight">üíé Tight (&lt;5%)</option>
        <option value="vig-normal">Normal (5‚Äì6%)</option>
        <option value="vig-wide">üíéüíé Wide (6‚Äì7%)</option>
        <option value="vig-soft">üíéüíéüíé Soft (‚â•7%)</option>
      </select>
    </div>
    <button class="btn-clear" onclick="clearFilters()">‚úï</button>
  </div>
</header>


<div id="asiaStats">
  <div class="as-title">Asia Handicap Results ‚Äî Home Perspective</div>
  <div class="as-row">
    <div class="as-card ww"><div class="as-card-label">Win Whole</div><div class="as-card-pct" id="as-ww-p">‚Äî</div><div class="as-card-count" id="as-ww">‚Äî</div></div>
    <div class="as-card wh"><div class="as-card-label">Win Half</div><div class="as-card-pct" id="as-wh-p">‚Äî</div><div class="as-card-count" id="as-wh">‚Äî</div></div>
    <div class="as-card dd"><div class="as-card-label">Draw</div><div class="as-card-pct" id="as-dd-p">‚Äî</div><div class="as-card-count" id="as-dd">‚Äî</div></div>
    <div class="as-card lh"><div class="as-card-label">Loss Half</div><div class="as-card-pct" id="as-lh-p">‚Äî</div><div class="as-card-count" id="as-lh">‚Äî</div></div>
    <div class="as-card lw"><div class="as-card-label">Loss Whole</div><div class="as-card-pct" id="as-lw-p">‚Äî</div><div class="as-card-count" id="as-lw">‚Äî</div></div>
  </div>
  <div class="as-bar-wrap" id="as-bar"></div>
</div>

<div id="loadingState"><div class="spinner"></div><span>Loading match data‚Ä¶</span></div>

<div id="errorState">
  <div style="font-size:36px">‚ö†Ô∏è</div>
  <h2>Could not load data</h2>
  <p id="errorMsg" style="font-size:12px;max-width:400px;line-height:1.6;color:var(--muted)"></p>
  <br/><button class="retry-btn" onclick="loadData()">‚Üª Retry</button>
</div>

<div class="table-scroll" id="tableArea" style="display:none">
  <table id="mainTable">
    <thead><tr>
      <th onclick="sortBy('DATE')" id="th-DATE">Date / Time <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('CATEGORY')" id="th-CATEGORY">League <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('TEAMH')" id="th-TEAMH">Match <span class="si">‚áÖ</span></th>
      <th id="th-PREDICT">H% / D% / A%</th>
      <th onclick="sortBy('ASIALINE')" id="th-ASIALINE">Line <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('ASIAH')" id="th-ASIAH">Asia H <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('ASIAA')" id="th-ASIAA">Asia A <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('JCTIPSUM')" id="th-JCTIPSUM">JC Sum <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('JCTIPSID')" id="th-JCTIPSID">JC SID <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('TIPSIDMAC')" id="th-TIPSIDMAC">SID Mac <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('TIPSONID')" id="th-TIPSONID">ON ID <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('GEMH')" id="th-GEMH">GemH <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('GEMD')" id="th-GEMD">GemD <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('GEMA')" id="th-GEMA">GemA <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('GPTH')" id="th-GPTH">GptH <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('GPTD')" id="th-GPTD">GptD <span class="si">‚áÖ</span></th>
      <th onclick="sortBy('GPTA')" id="th-GPTA">GptA <span class="si">‚áÖ</span></th>
      <th>Score</th>
      <th>Status</th>
    </tr></thead>
    <tbody id="tableBody"></tbody>
  </table>
  <div class="empty" id="emptyState" style="display:none"><span>üîé</span>No matches found.</div>
</div>

<div class="pagination" id="pagination"></div>

<div class="panel-overlay" id="panelOverlay" onclick="closePanelBg(event)">
  <div class="panel">
    <div class="ph">
      <div><div class="ph-title" id="panelTitle"></div><div class="ph-meta" id="panelMeta"></div></div>
      <button class="pc-btn" onclick="closePanel()">‚úï</button>
    </div>
    <div class="pb" id="panelBody"></div>
  </div>
</div>

<script>
var ALL=[],filtered=[],sortCol='DATE',sortDir=-1,pg=1,PG=30,selIdx=null;
var isMobile=window.innerWidth<600;
if(isMobile) PG=20;

function $(id){return document.getElementById(id);}

function expertScore(r){
  function ts(v){if(!v)return null;var u=String(v).toUpperCase();
    if(u==='H'||u==='1H'||u==='AH')return'H';
    if(u==='D'||u==='1D'||u==='AD')return'D';
    if(u==='A'||u==='1A'||u==='AA')return'A';
    return null;}
  var th=(ts(r.JCTIPSUM)==='H'?1:0)+(ts(r.JCTIPSID)==='H'?1:0)+(ts(r.TIPSIDMAC)==='H'?1:0)+(ts(r.TIPSONID)==='H'?1:0)+(r.GEMH||0)+(r.GPTH||0);
  var td=(ts(r.JCTIPSUM)==='D'?1:0)+(ts(r.JCTIPSID)==='D'?1:0)+(ts(r.TIPSIDMAC)==='D'?1:0)+(ts(r.TIPSONID)==='D'?1:0)+(r.GEMD||0)+(r.GPTD||0);
  var ta=(ts(r.JCTIPSUM)==='A'?1:0)+(ts(r.JCTIPSID)==='A'?1:0)+(ts(r.TIPSIDMAC)==='A'?1:0)+(ts(r.TIPSONID)==='A'?1:0)+(r.GEMA||0)+(r.GPTA||0);
  var tt=th+td+ta;
  if(!tt)return null;
  return{h:Math.round(th*100/tt),d:Math.round(td*100/tt),a:Math.round(ta*100/tt)};
}

function lowConfidence(r){
  function ts(v){if(!v)return null;var u=String(v).toUpperCase();
    if(u==='H'||u==='1H'||u==='AH')return'H';
    if(u==='D'||u==='1D'||u==='AD')return'D';
    if(u==='A'||u==='1A'||u==='AA')return'A';
    return null;}
  var tipCount=[r.JCTIPSUM,r.JCTIPSID,r.TIPSIDMAC,r.TIPSONID].filter(function(v){return ts(v)!==null;}).length;
  var gemGptTotal=(r.GEMH||0)+(r.GEMD||0)+(r.GEMA||0)+(r.GPTH||0)+(r.GPTD||0)+(r.GPTA||0);
  return tipCount<2||gemGptTotal<3;
}

function asiaOutcome(r){
  if(r.STATUS!=='Result'||r.ASIALINE==null||r.RESULTH==null||r.RESULTA==null)return null;
  var margin=Math.round((r.RESULTH-r.RESULTA+r.ASIALINE)*4)/4;
  if(margin>=0.5)return'ww';
  if(margin===0.25)return'wh';
  if(margin===0)return'dd';
  if(margin===-0.25)return'lh';
  return'lw';
}

function renderAsiaStats(data){
  var counts={ww:0,wh:0,dd:0,lh:0,lw:0};
  data.forEach(function(r){var o=asiaOutcome(r);if(o)counts[o]++;});
  var total=counts.ww+counts.wh+counts.dd+counts.lh+counts.lw;
  if(!total){document.getElementById('asiaStats').style.display='none';return;}
  document.getElementById('asiaStats').style.display='block';
  var keys=['ww','wh','dd','lh','lw'];
  keys.forEach(function(k){
    var pct=(counts[k]/total*100).toFixed(1);
    document.getElementById('as-'+k).textContent=counts[k].toLocaleString();
    document.getElementById('as-'+k+'-p').textContent=pct+'%';
  });
  var bar=document.getElementById('as-bar');
  bar.innerHTML=keys.map(function(k){
    var w=(counts[k]/total*100).toFixed(2);
    return'<div class="as-bar-'+k+'" style="width:'+w+'%;transition:width .4s ease" title="'+k+': '+counts[k]+'"></div>';
  }).join('');
}

function loadData(){
  var controller=new AbortController();
  var timer=setTimeout(function(){controller.abort();},10000);
  fetch('https://lotuswork17-creator.github.io/MySData/data.json?v='+Date.now(),{signal:controller.signal})
    .then(function(r){
      clearTimeout(timer);
      if(!r.ok) throw new Error('HTTP '+r.status+' ‚Äî make sure data.json is in the same folder as index.html');
      return r.json();
    })
    .then(function(d){
      ALL=d.records||[];
      var m=d.meta||{};
      $('hTotal').textContent=ALL.length.toLocaleString();
      $('hResult').textContent=ALL.filter(function(r){return r.STATUS==='Result';}).length.toLocaleString();
      $('hPreeve').textContent=ALL.filter(function(r){return r.STATUS==='PREEVE';}).length.toLocaleString();
      if(m.generated_at){
        var dt=new Date(m.generated_at);
        $('updatedAt').textContent='Updated '+dt.toLocaleDateString()+' '+dt.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});
      }
      var cats=Array.from(new Set(ALL.map(function(r){return r.CATEGORY;}).filter(Boolean))).sort();
      var sel=$('catSelect');
      cats.forEach(function(c){var o=document.createElement('option');o.value=c;o.textContent=c;sel.appendChild(o);});

      $('loadingState').style.display='none';
      $('tableArea').style.display='block';
      $('pagination').classList.add('pg-visible');
      $('resultsInline').style.display='inline';

      renderAsiaStats(ALL);
      $('th-DATE').classList.add('sort-desc');
      applyFilters();

      var t;
      $('searchInput').addEventListener('input',function(){clearTimeout(t);t=setTimeout(function(){pg=1;applyFilters();},300);});
      // Populate asialine dropdown
      var lines=Array.from(new Set(ALL.map(function(r){return r.ASIALINE;}).filter(function(v){return v!=null;}))).sort(function(a,b){return a-b;});
      var alsel=$('asialineSelect');
      // Add group options first
      var grpSep=document.createElement('option');grpSep.disabled=true;grpSep.textContent='‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ';alsel.appendChild(grpSep);
      var grpA=document.createElement('option');grpA.value='away-quarter';grpA.textContent='Away Quarter (-0.25 & -0.75)';alsel.appendChild(grpA);
      var grpH=document.createElement('option');grpH.value='home-quarter';grpH.textContent='Home Quarter (+0.25 & +0.75)';alsel.appendChild(grpH);
      var grpSep2=document.createElement('option');grpSep2.disabled=true;grpSep2.textContent='‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ';alsel.appendChild(grpSep2);
      lines.forEach(function(l){var o=document.createElement('option');o.value=String(l);o.textContent=l;alsel.appendChild(o);});
      $('catSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('statusSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('asialineSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('dateRangeSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('predictSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('expertSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('marketSelect').addEventListener('change',function(){pg=1;applyFilters();});
      $('vigSelect').addEventListener('change',function(){pg=1;applyFilters();});
      document.addEventListener('keydown',function(e){if(e.key==='Escape')closePanel();});
    })
    .catch(function(e){
      $('loadingState').style.display='none';
      $('errorState').style.display='flex';
      $('errorMsg').textContent=e.name==='AbortError'?'Request timed out after 10s ‚Äî check your internet connection and that data.json exists on GitHub.':e.message;
    });
}

function predictLead(r){
  var ph=r.PREDICTH||0,pd=r.PREDICTD||0,pa=r.PREDICTA||0;
  if(!ph&&!pd&&!pa)return null;
  if(ph>=pd&&ph>=pa)return'H';
  if(pd>=ph&&pd>=pa)return'D';
  return'A';
}
function expertLead(r){
  var e=expertScore(r);if(!e)return null;
  if(e.h>=e.d&&e.h>=e.a)return'H';
  if(e.d>=e.h&&e.d>=e.a)return'D';
  return'A';
}
function applyFilters(){
  var s=$('searchInput').value.toLowerCase(),cat=$('catSelect').value,st=$('statusSelect').value;
  var al=$('asialineSelect').value,dr=$('dateRangeSelect').value;
  var pf=$('predictSelect').value,ef=$('expertSelect').value,mf=$('marketSelect').value,vf=$('vigSelect').value;
  // Date range cutoff
  var cutoff=null;
  if(dr){
    var d=new Date();d.setMonth(d.getMonth()-parseInt(dr));
    cutoff=d.toISOString().slice(0,10);
  }
  filtered=ALL.filter(function(r){
    if(s&&!((r.TEAMH||'').toLowerCase().includes(s)||(r.TEAMA||'').toLowerCase().includes(s)))return false;
    if(cat&&r.CATEGORY!==cat)return false;
    if(st&&r.STATUS!==st)return false;
    if(cutoff&&r.DATE&&r.DATE<cutoff)return false;
    if(al){
      if(al==='away-quarter'){if(r.ASIALINE!=-0.25&&r.ASIALINE!=-0.75)return false;}
      else if(al==='home-quarter'){if(r.ASIALINE!=0.25&&r.ASIALINE!=0.75)return false;}
      else if(String(r.ASIALINE)!==al)return false;
    }
    // Predict filter
    if(pf){
      var ph=r.PREDICTH||0,pd=r.PREDICTD||0,pa=r.PREDICTA||0;
      var pl=predictLead(r);
      if(pf==='H-lead'&&pl!=='H')return false;
      if(pf==='D-lead'&&pl!=='D')return false;
      if(pf==='A-lead'&&pl!=='A')return false;
      if(pf==='H-weak'&&(pl!=='H'||ph>=50))return false;
      if(pf==='H-strong'&&ph<50)return false;
      if(pf==='H-vstrong'&&ph<70)return false;
      if(pf==='A-weak'&&(pl!=='A'||pa>=50))return false;
      if(pf==='A-strong'&&pa<50)return false;
      if(pf==='A-vstrong'&&pa<70)return false;
    }
    // Expert filter
    if(ef){
      var e=expertScore(r);
      var el=expertLead(r);
      var lc=lowConfidence(r);
      if(ef==='H-dom'){if(!e||el!=='H')return false;}
      if(ef==='H-strong-e'){if(!e||e.h<50)return false;}
      if(ef==='H-vstrong-e'){if(!e||e.h<70)return false;}
      if(ef==='H-ultra-e'){if(!e||e.h<90)return false;}
      if(ef==='A-dom'){if(!e||el!=='A')return false;}
      if(ef==='A-strong-e'){if(!e||e.a<50)return false;}
      if(ef==='A-vstrong-e'){if(!e||e.a<70)return false;}
      if(ef==='A-ultra-e'){if(!e||e.a<90)return false;}
      if(ef==='agree'){if(!e||predictLead(r)!==el)return false;}
      if(ef==='disagree'){if(!e||predictLead(r)===el||!predictLead(r))return false;}
      if(ef==='high-conf'&&lc)return false;
      if(ef==='high-conf-H'){if(lc||!e||el!=='H')return false;}
      if(ef==='high-conf-H50'){if(lc||!e||e.h<50)return false;}
      if(ef==='high-conf-H70'){if(lc||!e||e.h<70)return false;}
      if(ef==='high-conf-H90'){if(lc||!e||e.h<90)return false;}
      if(ef==='high-conf-A'){if(lc||!e||el!=='A')return false;}
      if(ef==='high-conf-A50'){if(lc||!e||e.a<50)return false;}
      if(ef==='high-conf-A70'){if(lc||!e||e.a<70)return false;}
      if(ef==='high-conf-A90'){if(lc||!e||e.a<90)return false;}
      if(ef==='low-conf'&&!lc)return false;
      if(ef==='low-conf-H'){if(!lc||!e||el!=='H')return false;}
      if(ef==='low-conf-H50'){if(!lc||!e||e.h<50)return false;}
      if(ef==='low-conf-H70'){if(!lc||!e||e.h<70)return false;}
      if(ef==='low-conf-H90'){if(!lc||!e||e.h<90)return false;}
      if(ef==='low-conf-A'){if(!lc||!e||el!=='A')return false;}
      if(ef==='low-conf-A50'){if(!lc||!e||e.a<50)return false;}
      if(ef==='low-conf-A70'){if(!lc||!e||e.a<70)return false;}
      if(ef==='low-conf-A90'){if(!lc||!e||e.a<90)return false;}
    }
    // Market Lean filter
    if(mf||vf){
      if(!r.ASIAH||!r.ASIAA||r.ASIAH<=0||r.ASIAA<=0)return false;
      var rh2=1/r.ASIAH,ra2=1/r.ASIAA,vig2=rh2+ra2;
      var fh2=rh2/vig2*100,vigPct2=(vig2-1)*100;
      if(mf==='balanced'&&(fh2<48||fh2>52))return false;
      if(mf==='h-slight'&&(fh2<52||fh2>=55))return false;
      if(mf==='h-clear'&&fh2<55)return false;
      if(mf==='a-slight'&&(fh2<45||fh2>=48))return false;
      if(mf==='a-clear'&&fh2>=45)return false;
      if(vf==='vig-tight'&&vigPct2>=5)return false;
      if(vf==='vig-normal'&&(vigPct2<5||vigPct2>=6))return false;
      if(vf==='vig-wide'&&(vigPct2<6||vigPct2>=7))return false;
      if(vf==='vig-soft'&&vigPct2<7)return false;
    }
    return true;
  });
  filtered.sort(function(a,b){var av=a[sortCol],bv=b[sortCol];if(av==null)return 1;if(bv==null)return-1;return(av<bv?-1:av>bv?1:0)*sortDir;});
  $('showCount').textContent=filtered.length.toLocaleString();
  $('totalCount').textContent=ALL.length.toLocaleString();
  renderAsiaStats(filtered);
  renderTable();renderPagination();
}

function sortBy(col){
  if(sortCol===col)sortDir*=-1;else{sortCol=col;sortDir=-1;}
  pg=1;
  document.querySelectorAll('thead th').forEach(function(th){th.classList.remove('sort-asc','sort-desc');});
  var th=$('th-'+col);if(th)th.classList.add(sortDir===1?'sort-asc':'sort-desc');
  applyFilters();
}

function toggleFilters(){
  var panel=document.getElementById('filtersPanel');
  var btn=document.getElementById('filterToggle');
  var lbl=document.getElementById('filterToggleLabel');
  var collapsed=panel.classList.toggle('collapsed');
  btn.classList.toggle('collapsed',collapsed);
  btn.classList.toggle('active',!collapsed);
  lbl.textContent=collapsed?'Show Filters':'Hide Filters';
}

function clearFilters(){
  $('searchInput').value='';$('catSelect').value='';$('statusSelect').value='';$('asialineSelect').value='';
  $('dateRangeSelect').value='';$('predictSelect').value='';$('expertSelect').value='';$('marketSelect').value='';$('vigSelect').value='';
  pg=1;applyFilters();
}

function asiaLineArrows(val,ln){
  if(val==null)return'‚Äî';
  var s=String(val);
  if(ln==null||ln===0)return s;
  var diff=Math.round((val-ln)*100)/100;
  if(diff===0)return s;
  var abs=Math.abs(diff);
  var n=abs>=1.0?3:abs>=0.5?2:1;
  var arrow=diff<0?'‚ñº':'‚ñ≤';
  var color=diff<0?'#f87171':'#60a5fa';
  var arrows=arrow.repeat(n);
  return s+'<span style="color:'+color+';font-size:10px;margin-left:2px">'+arrows+'</span>';
}
function asiaOddsArrows(lat,opn){
  if(lat==null||opn==null||opn===0||lat===0||lat===opn)return lat!=null?String(lat):'‚Äî';
  var s=String(lat);
  var n,arr,col;
  if(lat<opn){n=lat<opn*0.9?3:lat<opn*0.95?2:1;arr='‚ñº';col='#f87171';}
  else{n=lat>opn*1.1?3:lat>opn*1.05?2:1;arr='‚ñ≤';col='#60a5fa';}
  return s+'<span style="color:'+col+';font-size:10px;margin-left:2px">'+arr.repeat(n)+'</span>';
}
function vigSymbol(r){
  if(!r.ASIAH||!r.ASIAA||r.ASIAH<=0||r.ASIAA<=0)return '';
  var v=(1/r.ASIAH+1/r.ASIAA-1)*100;
  if(v<5)return '<span title="Tight vig &lt;5%" style="font-size:10px;opacity:.8">üíé</span>';
  if(v<6)return '';
  if(v<7)return '<span title="Wide vig 6-7%" style="font-size:10px;opacity:.8">üíéüíé</span>';
  return '<span title="Soft vig ‚â•7%" style="font-size:10px;opacity:.8">üíéüíéüíé</span>';
}
function renderTable(){
  var body=$('tableBody'),start=(pg-1)*PG,rows=filtered.slice(start,start+PG),s=$('searchInput').value;
  $('emptyState').style.display=rows.length?'none':'block';
  $('mainTable').style.display=rows.length?'':'none';
  if(isMobile){
    body.innerHTML=rows.map(function(r,i){
      var gi=start+i;
      var sc=r.STATUS==='Result'?'s-result':r.STATUS==='PREEVE'?'s-preeve':'s-cancel';
      var sl=r.STATUS==='PREEVE'?'Upcoming':(r.STATUS||'‚Äî');
      var time=r.TIME?fmtTime(r.TIME):'';

      // Score colour: red=home win, green=draw, blue=away win
      var scoreHtml;
      if(r.STATUS==='Result'){
        var rh=Number(r.RESULTH),ra=Number(r.RESULTA);
        var scoreColor=rh>ra?'#f87171':rh===ra?'#4ade80':'#60a5fa';
        scoreHtml='<span style="font-family:var(--mono);font-size:18px;font-weight:800;color:'+scoreColor+'">'+rh+' ‚Äì '+ra+'</span>';
      } else {
        scoreHtml='';
      }

      // League cell colour: (HomeScore - AwayScore + AsiaLine) vs ¬±0.25
      var catStyle='font-size:11px;margin-bottom:5px;';
      if(r.STATUS==='Result' && r.ASIALINE!=null){
        var margin=Number(r.RESULTH)-Number(r.RESULTA)+Number(r.ASIALINE);
        if(margin>0.25)        catStyle+='background:rgba(248,113,113,0.18);color:#fca5a5;padding:1px 5px;border-radius:4px;';
        else if(margin===0.25) catStyle+='color:#f87171;';
        else if(margin===-0.25)catStyle+='color:#60a5fa;';
        else if(margin<-0.25)  catStyle+='background:rgba(96,165,250,0.18);color:#93c5fd;padding:1px 5px;border-radius:4px;';
      }

      return '<tr onclick="openDetail('+gi+')" '+(selIdx===gi?'class="selected"':'')+'>'
        +'<td colspan="10">'
        +'<div style="display:flex;justify-content:space-between;align-items:flex-start">'
        +'<div style="flex:1;margin-right:70px">'
        +'<div style="font-size:11px;font-family:var(--mono);margin-bottom:3px"><span style="color:#94a3b8">'+esc(r.DATE||'')+'</span>'+(time?'<span style="color:#e2e8f0;font-weight:600;margin-left:5px">'+time+'</span>':'')+'</div>'
        +'<div style="display:flex;align-items:baseline;flex-wrap:wrap;gap:6px;margin-bottom:2px">'+'<span style="'+catStyle+'margin-bottom:0;flex-shrink:0">'+hl(esc(r.CATEGORY||''),s)+'</span>'+'<span style="font-size:13px;font-weight:700;color:var(--text);line-height:1.4">'+hl(esc(r.TEAMH||'?'),s)+'<span style="color:var(--muted);font-weight:400;font-size:11px;margin:0 5px">vs</span>'+hl(esc(r.TEAMA||'?'),s)+' '+vigSymbol(r)+'</span>'+'</div>'
        +'</div>'
        +'<div style="display:flex;flex-direction:column;align-items:flex-end;gap:6px">'
        +'<span class="status-badge '+sc+'">'+sl+'</span>'
        +scoreHtml
        +'</div></div>'
        +'<div style="margin-top:8px;font-family:var(--mono);font-size:10px">'
        +'<div style="display:grid;grid-template-columns:70px 1fr 1fr;gap:4px;color:var(--muted);font-size:9px;margin-bottom:3px;padding-bottom:2px;border-bottom:1px solid var(--border)">'
        +'<span>LINE</span><span>H</span><span>A</span></div>'
        +(r.ASIALINE!=null||r.ASIAH!=null||r.ASIAA!=null?
          '<div style="display:grid;grid-template-columns:70px 1fr 1fr;gap:4px;align-items:center;margin-bottom:2px">'
          +'<span style="color:var(--muted)"><span style="font-size:9px">G </span>'+asiaLineArrows(r.ASIALINE,r.ASIALINELN)+'</span>'
          +'<span style="color:#94a3b8">'+asiaOddsArrows(r.ASIAH,r.ASIAHLN)+'</span>'
          +'<span style="color:#94a3b8">'+asiaOddsArrows(r.ASIAA,r.ASIAALN)+'</span>'
          +'</div>':'') 
        +(r.ASIALINEMA!=null||r.ASIAHMAC!=null||r.ASIAAMAC!=null?
          '<div style="display:grid;grid-template-columns:70px 1fr 1fr;gap:4px;align-items:center;margin-bottom:2px">'
          +'<span style="color:#a78bfa"><span style="font-size:9px">M </span>'+asiaLineArrows(r.ASIALINEMA,r.ASIALINEM2)+'</span>'
          +'<span style="color:#94a3b8">'+asiaOddsArrows(r.ASIAHMAC,r.ASIAHMACLN)+'</span>'
          +'<span style="color:#94a3b8">'+asiaOddsArrows(r.ASIAAMAC,r.ASIAAMACLN)+'</span>'
          +'</div>':'') 
        +(r.ASIALINESB!=null||r.ASIAHSBO!=null||r.ASIAASBO!=null?
          '<div style="display:grid;grid-template-columns:70px 1fr 1fr;gap:4px;align-items:center">'
          +'<span style="color:#fb923c"><span style="font-size:9px">S </span>'+asiaLineArrows(r.ASIALINESB,r.ASIALINES2)+'</span>'
          +'<span style="color:#94a3b8">'+asiaOddsArrows(r.ASIAHSBO,r.ASIAHSBOLN)+'</span>'
          +'<span style="color:#94a3b8">'+asiaOddsArrows(r.ASIAASBO,r.ASIAASBOLN)+'</span>'
          +'</div>':'') 
        +'</div>'
        +'<div style="display:flex;gap:10px;margin-top:6px;font-family:var(--mono);font-size:10px;flex-wrap:wrap">'
        +'<span style="color:var(--muted)">Sum:</span> '+(function(v){if(!v)return'<span style="color:var(--muted)">‚Äî</span>';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.JCTIPSUM)
        +' <span style="color:var(--muted)">SID:</span> '+(function(v){if(!v)return'<span style="color:var(--muted)">‚Äî</span>';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.JCTIPSID)
        +' <span style="color:var(--muted)">Mac:</span> '+(function(v){if(!v)return'<span style="color:var(--muted)">‚Äî</span>';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.TIPSIDMAC)
        +' <span style="color:var(--muted)">ON:</span> '+(function(v){if(!v)return'<span style="color:var(--muted)">‚Äî</span>';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.TIPSONID)
        +'</div>'
        +'<div style="display:flex;gap:10px;margin-top:4px;font-family:var(--mono);font-size:10px;color:#94a3b8">'
        +'<span>Gem: '+(r.GEMH!=null?r.GEMH:'\u2014')+' / '+(r.GEMD!=null?r.GEMD:'\u2014')+' / '+(r.GEMA!=null?r.GEMA:'\u2014')+'</span>'
        +'<span style="margin-left:8px">Gpt: '+(r.GPTH!=null?r.GPTH:'\u2014')+' / '+(r.GPTD!=null?r.GPTD:'\u2014')+' / '+(r.GPTA!=null?r.GPTA:'\u2014')+'</span>'
        +'</div>'
        +(r.PREDICTH||r.PREDICTD||r.PREDICTA?'<div style="margin-top:8px">'
          +(lowConfidence(r)?'<div style="font-size:9px;color:var(--warn);opacity:.8;font-family:var(--mono);margin-bottom:4px">‚ö† Low confidence</div>':'')
          +'<div style="display:flex;justify-content:space-between;font-size:10px;font-family:var(--mono);margin-bottom:3px'+(lowConfidence(r)?';opacity:.5':'')+'">'
          +'<span style="color:#f87171">H '+(r.PREDICTH||0)+'%</span><span style="color:#4ade80">D '+(r.PREDICTD||0)+'%</span><span style="color:#60a5fa">A '+(r.PREDICTA||0)+'%</span></div>'
          +(lowConfidence(r)
            ?'<div style="height:6px;border-radius:3px;background:var(--border);display:flex;overflow:hidden;opacity:.4">'
              +'<div style="width:'+(r.PREDICTH||0)+'%;background:repeating-linear-gradient(90deg,#f87171 0 3px,transparent 3px 6px)"></div>'
              +'<div style="width:'+(r.PREDICTD||0)+'%;background:repeating-linear-gradient(90deg,#4ade80 0 3px,transparent 3px 6px)"></div>'
              +'<div style="width:'+(r.PREDICTA||0)+'%;background:repeating-linear-gradient(90deg,#60a5fa 0 3px,transparent 3px 6px)"></div>'
              +'</div>'
            :'<div style="height:6px;border-radius:3px;background:var(--border);display:flex;overflow:hidden">'
              +'<div style="width:'+(r.PREDICTH||0)+'%;background:#f87171"></div>'
              +'<div style="width:'+(r.PREDICTD||0)+'%;background:#4ade80"></div>'
              +'<div style="width:'+(r.PREDICTA||0)+'%;background:#60a5fa"></div>'
              +'</div>')
          +'</div>':'')
        +(function(){
          var e=expertScore(r);if(!e)return'';
          var lc=lowConfidence(r);
          return'<div style="margin-top:6px">'
            +'<div style="display:flex;justify-content:space-between;font-size:10px;font-family:var(--mono);margin-bottom:3px'+(lc?';opacity:.5':'')+'">'
            +'<span style="color:#f87171">Expert H '+e.h+'%</span><span style="color:#4ade80">D '+e.d+'%</span><span style="color:#60a5fa">A '+e.a+'%</span></div>'
            +(lc
              ?'<div style="height:12px;border-radius:4px;background:var(--border);display:flex;overflow:hidden;opacity:.4">'
                +'<div style="width:'+e.h+'%;background:repeating-linear-gradient(90deg,rgba(248,113,113,.9) 0 4px,transparent 4px 8px)"></div>'
                +'<div style="width:'+e.d+'%;background:repeating-linear-gradient(90deg,rgba(74,222,128,.9) 0 4px,transparent 4px 8px)"></div>'
                +'<div style="width:'+e.a+'%;background:repeating-linear-gradient(90deg,rgba(96,165,250,.9) 0 4px,transparent 4px 8px)"></div>'
                +'</div>'
              :'<div style="height:12px;border-radius:4px;background:var(--border);display:flex;overflow:hidden">'
                +'<div style="width:'+e.h+'%;background:#f87171"></div>'
                +'<div style="width:'+e.d+'%;background:#4ade80"></div>'
                +'<div style="width:'+e.a+'%;background:#60a5fa"></div>'
                +'</div>')
            +'</div>';
        })()
        +'</td></tr>';
    }).join('');
  } else {
    body.innerHTML=rows.map(function(r,i){
      var gi=start+i;
      var sc=r.STATUS==='Result'?'s-result':r.STATUS==='PREEVE'?'s-preeve':'s-cancel';
      var sl=r.STATUS==='PREEVE'?'Upcoming':(r.STATUS||'‚Äî');

      // Score colour: red=home win, green=draw, blue=away win
      var scoreHtml;
      if(r.STATUS==='Result'){
        var rh=Number(r.RESULTH),ra=Number(r.RESULTA);
        var scoreColor=rh>ra?'#f87171':rh===ra?'#4ade80':'#60a5fa';
        scoreHtml='<span style="font-weight:700;color:'+scoreColor+'">'+rh+' ‚Äì '+ra+'</span>';
      } else {
        scoreHtml='<span style="color:var(--muted)">‚Äî</span>';
      }

      // League cell colour based on: (HomeScore - AwayScore + AsiaLine) vs ¬±0.25
      var leagueCellStyle='';
      if(r.STATUS==='Result' && r.ASIALINE!=null){
        var margin=Number(r.RESULTH)-Number(r.RESULTA)+Number(r.ASIALINE);
        if(margin>0.25)       leagueCellStyle='background:rgba(248,113,113,0.18);color:#fca5a5;';
        else if(margin===0.25) leagueCellStyle='color:#f87171;';
        else if(margin===-0.25)leagueCellStyle='color:#60a5fa;';
        else if(margin<-0.25)  leagueCellStyle='background:rgba(96,165,250,0.18);color:#93c5fd;';
      }

      return '<tr onclick="openDetail('+gi+')" '+(selIdx===gi?'class="selected"':'')+'>'
        +'<td><div style="color:#94a3b8">'+esc(r.DATE||'‚Äî')+'</div><div style="color:#e2e8f0;font-size:11px;font-weight:600">'+(r.TIME?fmtTime(r.TIME):'')+'</div></td>'
        +'<td class="ccell" title="'+esc(r.CATEGORY||'')+'" style="'+leagueCellStyle+'">'+hl(esc(r.CATEGORY||'‚Äî'),s)+'</td>'
        +'<td class="tcell" style="white-space:normal;max-width:180px"><span style="font-weight:600">'+hl(esc(r.TEAMH||'‚Äî'),s)+'</span><span style="color:var(--muted);font-size:10px;margin:0 5px">vs</span><span style="font-weight:600">'+hl(esc(r.TEAMA||'‚Äî'),s)+'</span>'+vigSymbol(r)+'</td>'
        +'<td>'+(function(){
          var ph=r.PREDICTH||0,pd=r.PREDICTD||0,pa=r.PREDICTA||0;
          var e=expertScore(r);
          var lc=lowConfidence(r);
          var html='';
          if(ph||pd||pa){
            html+='<div style="min-width:100px">'
              +'<div style="display:flex;justify-content:space-between;font-size:9px;font-family:var(--mono);margin-bottom:2px'+(lc?';opacity:.5':'')+'">'
              +'<span style="color:#f87171">'+ph+'%</span><span style="color:#4ade80">'+pd+'%</span><span style="color:#60a5fa">'+pa+'%</span></div>'
              +(lc
                ?'<div style="height:4px;border-radius:2px;background:var(--border);display:flex;overflow:hidden;opacity:.4">'
                  +'<div style="width:'+ph+'%;background:repeating-linear-gradient(90deg,#f87171 0 3px,transparent 3px 6px)"></div>'
                  +'<div style="width:'+pd+'%;background:repeating-linear-gradient(90deg,#4ade80 0 3px,transparent 3px 6px)"></div>'
                  +'<div style="width:'+pa+'%;background:repeating-linear-gradient(90deg,#60a5fa 0 3px,transparent 3px 6px)"></div>'
                  +'</div>'
                :'<div style="height:4px;border-radius:2px;background:var(--border);display:flex;overflow:hidden">'
                  +'<div style="width:'+ph+'%;background:#f87171"></div>'
                  +'<div style="width:'+pd+'%;background:#4ade80"></div>'
                  +'<div style="width:'+pa+'%;background:#60a5fa"></div>'
                  +'</div>')
              +'</div>';
          }
          if(e){
            html+='<div style="min-width:100px;margin-top:3px">'
              +'<div style="display:flex;justify-content:space-between;font-size:9px;font-family:var(--mono);margin-bottom:2px'+(lc?';opacity:.5':'')+'">'
              +'<span style="color:#f87171;opacity:.7">E'+e.h+'%</span><span style="color:#4ade80;opacity:.7">'+e.d+'%</span><span style="color:#60a5fa;opacity:.7">'+e.a+'%</span></div>'
              +(lc
                ?'<div style="height:8px;border-radius:3px;background:var(--border);display:flex;overflow:hidden;opacity:.4">'
                  +'<div style="width:'+e.h+'%;background:repeating-linear-gradient(90deg,rgba(248,113,113,.9) 0 4px,transparent 4px 8px)"></div>'
                  +'<div style="width:'+e.d+'%;background:repeating-linear-gradient(90deg,rgba(74,222,128,.9) 0 4px,transparent 4px 8px)"></div>'
                  +'<div style="width:'+e.a+'%;background:repeating-linear-gradient(90deg,rgba(96,165,250,.9) 0 4px,transparent 4px 8px)"></div>'
                  +'</div>'
                :'<div style="height:8px;border-radius:3px;background:var(--border);display:flex;overflow:hidden">'
                  +'<div style="width:'+e.h+'%;background:rgba(248,113,113,.6)"></div>'
                  +'<div style="width:'+e.d+'%;background:rgba(74,222,128,.6)"></div>'
                  +'<div style="width:'+e.a+'%;background:rgba(96,165,250,.6)"></div>'
                  +'</div>')
              +'</div>';
          }
          return html||'<span style="color:var(--muted)">‚Äî</span>';
        })()
        +'<td class="oc" style="line-height:1.7">'
        +(r.ASIALINE!=null?'<div><span style="color:var(--muted);font-size:9px">G </span>'+asiaLineArrows(r.ASIALINE,r.ASIALINELN)+'</div>':'')
        +(r.ASIALINEMA!=null?'<div><span style="color:#a78bfa;font-size:9px">M </span>'+asiaLineArrows(r.ASIALINEMA,r.ASIALINEM2)+'</div>':'')
        +(r.ASIALINESB!=null?'<div><span style="color:#fb923c;font-size:9px">S </span>'+asiaLineArrows(r.ASIALINESB,r.ASIALINES2)+'</div>':'')
        +'</td>'
        +'<td class="oc" style="line-height:1.7">'
        +(r.ASIAH!=null?'<div>'+asiaOddsArrows(r.ASIAH,r.ASIAHLN)+'</div>':'')
        +(r.ASIAHMAC!=null?'<div>'+asiaOddsArrows(r.ASIAHMAC,r.ASIAHMACLN)+'</div>':'')
        +(r.ASIAHSBO!=null?'<div>'+asiaOddsArrows(r.ASIAHSBO,r.ASIAHSBOLN)+'</div>':'')
        +'</td>'
        +'<td class="oc" style="line-height:1.7">'
        +(r.ASIAA!=null?'<div>'+asiaOddsArrows(r.ASIAA,r.ASIAALN)+'</div>':'')
        +(r.ASIAAMAC!=null?'<div>'+asiaOddsArrows(r.ASIAAMAC,r.ASIAAMACLN)+'</div>':'')
        +(r.ASIAASBO!=null?'<div>'+asiaOddsArrows(r.ASIAASBO,r.ASIAASBOLN)+'</div>':'')
        +'</td>'
        +'<td class="oc">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.JCTIPSUM)+'</td>'
        +'<td class="oc">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.JCTIPSID)+'</td>'
        +'<td class="oc">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.TIPSIDMAC)+'</td>'
        +'<td class="oc">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.TIPSONID)+'</td>'
        +'<td class="oc">'+(r.GEMH!=null?r.GEMH:'\u2014')+'</td>'
        +'<td class="oc">'+(r.GEMD!=null?r.GEMD:'\u2014')+'</td>'
        +'<td class="oc">'+(r.GEMA!=null?r.GEMA:'\u2014')+'</td>'
        +'<td class="oc">'+(r.GPTH!=null?r.GPTH:'\u2014')+'</td>'
        +'<td class="oc">'+(r.GPTD!=null?r.GPTD:'\u2014')+'</td>'
        +'<td class="oc">'+(r.GPTA!=null?r.GPTA:'\u2014')+'</td>'
        +'<td>'+scoreHtml+'</td>'
        +'<td><span class="status-badge '+sc+'">'+sl+'</span></td>'
        +'</tr>';
    }).join('');
  }
}

function fmtTime(t){var s=String(t).padStart(4,'0');return s.slice(0,-2)+':'+s.slice(-2);}
function hl(text,q){if(!q)return text;var i=text.toLowerCase().indexOf(q.toLowerCase());if(i===-1)return text;return text.slice(0,i)+'<mark>'+text.slice(i,i+q.length)+'</mark>'+text.slice(i+q.length);}
function esc(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

function renderPagination(){
  var total=Math.ceil(filtered.length/PG),el=$('pagination');
  if(total<=1){el.innerHTML='';el.classList.remove('pg-visible');return;}
  el.classList.add('pg-visible');
  var range=[];for(var p=1;p<=total;p++)if(p===1||p===total||Math.abs(p-pg)<=2)range.push(p);
  var html='<button class="pg-btn" '+(pg<=1?'disabled':'')+' onclick="goPage('+(pg-1)+')">‚Äπ</button>';
  var prev=0;
  range.forEach(function(p){if(p-prev>1)html+='<span style="color:var(--muted);padding:0 2px">‚Ä¶</span>';html+='<button class="pg-btn '+(p===pg?'active':'')+'" onclick="goPage('+p+')">'+p+'</button>';prev=p;});
  html+='<button class="pg-btn" '+(pg>=total?'disabled':'')+' onclick="goPage('+(pg+1)+')">‚Ä∫</button>';
  html+='<span class="pg-info">'+pg+' / '+total+'</span>';
  html+='<input class="pg-input" type="number" min="1" max="'+total+'" value="'+pg+'" onchange="goPage(Math.min('+total+',Math.max(1,parseInt(this.value)||1)))" title="Jump to page"/>';
  el.innerHTML=html;
}
function goPage(p){pg=p;renderTable();renderPagination();$('tableArea').scrollTop=0;}

function openDetail(idx){
  selIdx=idx;var r=filtered[idx];
  document.querySelectorAll('tbody tr').forEach(function(tr,i){tr.classList.toggle('selected',(pg-1)*PG+i===idx);});
  $('panelTitle').innerHTML=esc((r.TEAMH||'?')+' vs '+(r.TEAMA||'?'))+' '+vigSymbol(r);
  $('panelMeta').textContent=(r.DATE||'')+(r.TIME?' '+fmtTime(r.TIME):'')+' ¬∑ '+(r.CATEGORY||'')+' ¬∑ '+(r.STATUS||'');
  var ph=r.PREDICTH||0,pd=r.PREDICTD||0,pa=r.PREDICTA||0,pt=ph+pd+pa||1;
  var res='';
  if(r.STATUS==='Result'){
    var hw=r.RESULTH>r.RESULTA,aw=r.RESULTA>r.RESULTH;
    res='<div class="dc full"><h3>‚öΩ Match Result</h3>'
      +'<div class="sd"><div class="st"><div class="stn">'+esc(r.TEAMH||'Home')+'</div><div class="ssc" style="color:'+(hw?'var(--accent)':'var(--text)')+'">'+r.RESULTH+'</div></div>'
      +'<div class="sdiv">‚Äî</div>'
      +'<div class="st"><div class="stn">'+esc(r.TEAMA||'Away')+'</div><div class="ssc" style="color:'+(aw?'var(--accent)':'var(--text)')+'">'+r.RESULTA+'</div></div></div>'
      +(r.RESULTFH!=null?'<div class="hts">Half-time: '+r.RESULTFH+' ‚Äì '+r.RESULTFA+'</div>':'')+'</div>';
  }
  $('panelBody').innerHTML=res
    +'<div class="dc full"><h3>üí° Tips Summary</h3><div class="tg">'
    +'<div class="ti"><div class="tl">JC Tips Sum</div><div class="tv">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.JCTIPSUM)+'</div></div>'
    +'<div class="ti"><div class="tl">JC Tips SID</div><div class="tv">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.JCTIPSID)+'</div></div>'
    +'<div class="ti"><div class="tl">Tips SID MAC</div><div class="tv">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.TIPSIDMAC)+'</div></div>'
    +'<div class="ti"><div class="tl">Tips ON ID</div><div class="tv">'+(function(v){if(!v)return'‚Äî';var c=v.includes('H')?'#f87171':v.includes('D')?'#4ade80':v.includes('A')?'#60a5fa':'var(--text)';return'<span style="color:'+c+';font-weight:700">'+v+'</span>';})(r.TIPSONID)+'</div></div>'
    +'</div><div class="tg2">'
    +'<div class="ti"><div class="tl">GEM H/D/A</div><div class="tv" style="font-family:var(--mono);font-size:12px"><span style="color:#f87171">'+( r.GEMH!=null?r.GEMH:'‚Äî')+'</span> / <span style="color:#4ade80">'+( r.GEMD!=null?r.GEMD:'‚Äî')+'</span> / <span style="color:#60a5fa">'+( r.GEMA!=null?r.GEMA:'‚Äî')+'</span></div></div>'
    +'<div class="ti"><div class="tl">GPT H/D/A</div><div class="tv" style="font-family:var(--mono);font-size:12px"><span style="color:#f87171">'+( r.GPTH!=null?r.GPTH:'‚Äî')+'</span> / <span style="color:#4ade80">'+( r.GPTD!=null?r.GPTD:'‚Äî')+'</span> / <span style="color:#60a5fa">'+( r.GPTA!=null?r.GPTA:'‚Äî')+'</span></div></div>'
    +'</div></div>'
    +(r.JCTIPS1?'<div style="margin-top:10px;border-top:1px solid var(--border);padding-top:10px">'
      +'<div style="font-size:10px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">JC Tips Analysis</div>'
      +(r.JCTIPS1?'<div style="font-size:12px;color:var(--accent);font-weight:600;margin-bottom:6px">'+r.JCTIPS1+'</div>':'')
      +(r.JCTIPS2?'<div style="font-size:11px;color:var(--text);line-height:1.6;margin-bottom:6px">'+r.JCTIPS2+'</div>':'')
      +(r.JCTIPS3?'<div style="font-size:11px;color:var(--muted);line-height:1.6">'+r.JCTIPS3+'</div>':'')
      +'</div>':'')
    +(r.TIPSMAC?'<div style="margin-top:10px;border-top:1px solid var(--border);padding-top:10px">'
      +'<div style="font-size:10px;font-weight:700;color:#a78bfa;text-transform:uppercase;letter-spacing:.06em;margin-bottom:8px">üé∞ Macau Tips</div>'
      +'<div style="font-size:11px;color:var(--text);line-height:1.7">'+r.TIPSMAC+'</div>'
      +'</div>':'')
    +'</div>'
    +'<div class="dc"><h3>üìä Prediction %</h3>'
    +'<div class="pl"><span style="color:var(--accent2)">H '+ph+'%</span><span style="color:#a78bfa">D '+pd+'%</span><span style="color:var(--warn)">A '+pa+'%</span></div>'
    +'<div class="pbar"><div class="ph2" style="width:'+(ph/pt*100).toFixed(1)+'%"></div><div class="pd2" style="width:'+(pd/pt*100).toFixed(1)+'%"></div><div class="pa2" style="width:'+(pa/pt*100).toFixed(1)+'%"></div></div>'
    +'<div style="margin-top:10px">'
    +'<div class="dr"><span class="dk">Recent H/D/A</span><span class="dv">'+r.RECENTH+' / '+r.RECENTD+' / '+r.RECENTA+'</span></div>'
    +'<div class="dr"><span class="dk">1-Year H/D/A</span><span class="dv">'+r.REC1YRH+' / '+r.REC1YRD+' / '+r.REC1YRA+'</span></div>'
    +'<div class="dr"><span class="dk">3M Home W/D/L</span><span class="dv">'+r.REC3MHH+' / '+r.REC3MHD+' / '+r.REC3MHA+'</span></div>'
    +'<div class="dr"><span class="dk">3M Away W/D/L</span><span class="dv">'+r.REC3MAH+' / '+r.REC3MAD+' / '+r.REC3MAA+'</span></div>'
    +'</div></div>'
    +'<div class="dc full"><h3>üìà 1X2 Odds</h3>'
    +'<table class="ot"><thead><tr><th></th><th>Home</th><th>Draw</th><th>Away</th></tr></thead><tbody>'
    +'<tr><td class="ol">Opening</td><td>'+(r.ODDSHLN!=null?r.ODDSHLN:'\u2014')+'</td><td>'+(r.ODDSDLN!=null?r.ODDSDLN:'\u2014')+'</td><td>'+(r.ODDSALN!=null?r.ODDSALN:'\u2014')+'</td></tr>'
    +'<tr><td class="ol">Latest</td>'+'<td>'+asiaOddsArrows(r.ODDSH,r.ODDSHLN)+'</td>'+'<td>'+asiaOddsArrows(r.ODDSD,r.ODDSDLN)+'</td>'+'<td>'+asiaOddsArrows(r.ODDSA,r.ODDSALN)+'</td>'+'</tr>'
    +'</tbody></table></div>'
    +'<div class="dc full"><h3>üìà Asian Handicap</h3>'
    +(function(){
      function ahVal(v){return v!=null?String(v):'‚Äî';}
      // Line diff: absolute movement, skip if open==0
      function ahDiff(latest,open){
        if(latest==null||open==null||open===0)return'';
        var d=Math.round((latest-open)*100)/100;
        if(d===0)return'';
        var abs=Math.abs(d);
        var n=abs>=1.0?3:abs>=0.5?2:1;
        var arr=d>0?'‚ñ≤':'‚ñº';
        var col=d>0?'#60a5fa':'#f87171';
        return '<span style="color:'+col+';font-size:9px;margin-left:3px">'+arr.repeat(n)+'</span>';
      }
      // Odds diff: percentage-based for Asia H / Asia A
      function ahOddsDiff(lat,opn){
        if(lat==null||opn==null||opn===0||lat===0)return'';
        if(lat===opn)return'';
        var n,arr,col;
        if(lat<opn){
          // dropped
          n=lat<opn*0.9?3:lat<opn*0.95?2:1;
          arr='‚ñº';col='#f87171';
        } else {
          // rose
          n=lat>opn*1.1?3:lat>opn*1.05?2:1;
          arr='‚ñ≤';col='#60a5fa';
        }
        return '<span style="color:'+col+';font-size:9px;margin-left:3px">'+arr.repeat(n)+'</span>';
      }
      function ahRow(label,color,openLine,openH,openA,latLine,latH,latA){
        return '<div style="border:1px solid var(--border);border-radius:8px;padding:9px 12px;margin-bottom:7px">'
          +'<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">'
          +'<span style="font-size:10px;font-weight:700;color:'+color+';text-transform:uppercase;letter-spacing:.05em">'+label+'</span>'
          +'<span style="font-size:9px;color:var(--muted);font-family:var(--mono)">Open ‚Üí Latest</span></div>'
          +'<div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:4px">'
          +'<div style="text-align:center"><div style="font-size:9px;color:var(--muted);margin-bottom:3px">LINE</div>'
          +'<div style="font-size:11px;font-family:var(--mono);color:var(--muted)">'+ahVal(openLine)+'</div>'
          +'<div style="font-size:12px;font-weight:700;font-family:var(--mono);color:var(--text)">'+ahVal(latLine)+ahDiff(latLine,openLine)+'</div></div>'
          +'<div style="text-align:center"><div style="font-size:9px;color:var(--muted);margin-bottom:3px">ASIA H</div>'
          +'<div style="font-size:11px;font-family:var(--mono);color:var(--muted)">'+ahVal(openH)+'</div>'
          +'<div style="font-size:12px;font-weight:700;font-family:var(--mono);color:var(--text)">'+ahVal(latH)+ahOddsDiff(latH,openH)+'</div></div>'
          +'<div style="text-align:center"><div style="font-size:9px;color:var(--muted);margin-bottom:3px">ASIA A</div>'
          +'<div style="font-size:11px;font-family:var(--mono);color:var(--muted)">'+ahVal(openA)+'</div>'
          +'<div style="font-size:12px;font-weight:700;font-family:var(--mono);color:var(--text)">'+ahVal(latA)+ahOddsDiff(latA,openA)+'</div></div>'
          +'</div></div>';
      }
      return ahRow('General','var(--muted)',r.ASIALINELN,r.ASIAHLN,r.ASIAALN,r.ASIALINE,r.ASIAH,r.ASIAA)
        +ahRow('Macau','#a78bfa',r.ASIALINEM2,r.ASIAHMACLN,r.ASIAAMACLN,r.ASIALINEMA,r.ASIAHMAC,r.ASIAAMAC)
        +ahRow('SBO','#fb923c',r.ASIALINES2,r.ASIAHSBOLN,r.ASIAASBOLN,r.ASIALINESB,r.ASIAHSBO,r.ASIAASBO);
    })()
    +'</div>'
    +'<div class="dc"><h3>‚ÑπÔ∏è Info</h3>'
    
    +'<div class="dr"><span class="dk">Match ID</span><span class="dv" style="font-size:10px">'+(r.MATCHID||'‚Äî')+'</span></div>'
    +'</div>';
  $('panelOverlay').classList.add('open');
}
function closePanelBg(e){if(e.target===$('panelOverlay'))closePanel();}
function closePanel(){$('panelOverlay').classList.remove('open');}

loadData();
</script>
</body>
</html>
